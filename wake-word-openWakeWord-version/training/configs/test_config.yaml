# 🧠 Configuración de TEST del Modelo "Puertocho"
# VERSION REDUCIDA PARA PRUEBAS

# Configuración del modelo
model:
  name: "puertocho_test"
  architecture: "mel_stft_1d_cnn"
  sample_rate: 16000
  frame_length: 1280
  num_mel_features: 32
  num_classes: 1

# Configuración de entrenamiento - REDUCIDA PARA TEST
training:
  batch_size: 4                    # Reducido para test rápido
  learning_rate: 1e-4
  epochs: 5                        # Solo 5 épocas para test
  early_stopping_patience: 3       # Parar más rápido
  validation_split: 0.2
  
  # Directorios
  models_dir: "test_models"         # Directorio separado
  logs_dir: "test_logs"             # Logs separados
  
  save_every_n_epochs: 2           # Guardar cada 2 épocas
  save_best_only: true

# Configuración de datos - DATASET REDUCIDO
data:
  base_dir: "data"
  positive_dir: "data/all_train_samples"  # Usar las muestras completas
  negative_dir: "data/negative"
  
  # Límites para test rápido
  max_positive_samples: 100         # Solo 100 muestras positivas
  max_negative_samples: 200         # Solo 200 muestras negativas
  
  target_fpr: 0.5
  target_fnr: 0.05
  
  normalize_audio: true
  apply_augmentation: false         # Sin augmentation para test

# Configuración de optimización
optimization:
  optimizer: "adamw"
  weight_decay: 0.01
  use_amp: true                     # Mantener AMP
  gradient_clip_norm: 1.0
  scheduler: "onecycle"
  warmup_steps: 50                  # Menos steps de warmup
  loss_function: "bce_with_logits"

# Configuración de validación
validation:
  metrics:
    - "accuracy"
    - "precision"
    - "recall"
    - "f1_score"
  classification_threshold: 0.5
  validate_every_n_epochs: 1

# Configuración de logging - MÁS VERBOSO PARA TEST
logging:
  level: "DEBUG"                    # Máximo detalle para test
  use_tensorboard: true
  tensorboard_log_dir: "test_logs/tensorboard"
  use_wandb: false
  log_every_n_steps: 10             # Log más frecuente

# Configuración de hardware
hardware:
  gpu_memory_fraction: 0.7          # Menos memoria para test
  allow_growth: true
  num_workers: 2                    # Menos workers
  pin_memory: true

# Configuración de reproducibilidad
reproducibility:
  seed: 42
  deterministic: false
  benchmark: true

# Configuración específica de openWakeWord
openwakeword:
  model_architecture:
    type: "1d_cnn"
    num_layers: 3                   # Menos capas para test rápido
    hidden_size: 64                 # Más pequeño
    dropout: 0.3
    
  input_features:
    type: "mel_spectrogram"
    n_mels: 32
    hop_length: 320
    win_length: 640
    
  postprocessing:
    smoothing_window: 3             # Ventana más pequeña
    threshold_adjustment: 0.0

# Configuración de exportación
export:
  export_onnx: true
  onnx_opset: 11
  onnx_dynamic_axes: true
  onnx_optimize: true
  onnx_fp16: false

# Configuración de pruebas
testing:
  test_split: 0.1
  final_evaluation_metrics:
    - "accuracy"
    - "precision" 
    - "recall"
    - "f1_score"
    - "confusion_matrix"

# Notas de configuración
notes: |
  Configuración de TEST para verificar funcionamiento:
  - Dataset reducido: 100 positivas + 200 negativas
  - Solo 5 épocas de entrenamiento
  - Logging detallado para debugging
  - Modelo más pequeño y rápido
  - Sin data augmentation para simplicidad 